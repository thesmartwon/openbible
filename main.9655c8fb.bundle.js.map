{"version":3,"sources":["webpack:///./src/pages/settings.css?562f","webpack:///./src/components/paragraphs/verse.css?6815","webpack:///./src/components/readers/readers.css?6f08","webpack:///./src/components/nav/nav.css?9fd9","webpack:///./src/components/dropdown/dropdown.css?5e30","webpack:///./src/components/paragraphs/paragraph.css?795e","webpack:///./src/components/reader/reader.css?3da7","webpack:///./src/components/button/button.css?fcd9","webpack:///./src/components/paragraphs/highlights.css?a709","webpack:///./src/components/paragraphs/versenote.css?3b9b","webpack:///./src/components/nav/nav.tsx","webpack:///./src/utils/classnames.ts","webpack:///./src/components/button/button.tsx","webpack:///./src/components/dropdown/dropdown.tsx","webpack:///./src/utils/books.ts","webpack:///./src/utils/highlights.ts","webpack:///./src/utils/settings.ts","webpack:///./src/components/paragraphs/select.ts","webpack:///./src/components/paragraphs/notecontext.tsx","webpack:///./src/icons/fa-edit.svg","webpack:///./src/components/paragraphs/versenote.tsx","webpack:///./src/components/paragraphs/verse.tsx","webpack:///./src/components/paragraphs/paragraph.tsx","webpack:///./src/components/paragraphs/paragraphs.tsx","webpack:///./src/utils/notes.ts","webpack:///./src/icons/fa-highlighter.svg","webpack:///./src/icons/md-add-comment.svg","webpack:///./src/components/reader/reader.tsx","webpack:///./src/components/readers/readers.tsx","webpack:///./src/utils/readers.ts","webpack:///./src/pages/home.tsx","webpack:///./src/pages/about.tsx","webpack:///./src/utils/cssVars.ts","webpack:///./src/pages/settings.tsx","webpack:///./src/app.tsx"],"names":["module","exports","NavLink","props","activeClassName","Nav","class","styles","header","navbarGrow","navbar","navbarBrand","href","style","display","target","bugs","url","form","placeholder","classnames","args","Array","prototype","slice","call","filter","Boolean","join","Button","forwardRef","ref","button","variant","onClick","tabIndex","children","Dropdown","isOpen","createRef","ev","buttonRef","current","buttonRef2","ulRef","contains","setState","document","removeEventListener","close","preventDefault","_ev","state","addEventListener","index","bubbleUp","onSelect","render","dropdown","this","iconButton","toggleOpen","selected","icon","dropdownList","isRight","dropdownListRight","toChildArray","map","child","selectItem","Component","cache","books","name","chapters","texts","getKey","book","chapter","getLocalHighlights","key","JSON","parse","localStorage","getItem","getLocalSetting","setting","selectedNodes","copyableTags","copyStyles","BODY","P","SPAN","iterateOverRange","range","rangeFn","node","it","createNodeIterator","commonAncestorContainer","hitFirstNode","nextNode","startContainer","endContainer","getStyles","nodeStyles","getComputedStyle","nodeName","replace","getRange","selection","window","getSelection","rangeCount","getRangeAt","startOffset","endOffset","onSelectChange","setStart","length","setEnd","snapToWords","push","parentNode","onDoubleClickVerseNumber","console","log","onCopy","toCopy","toCopyHTML","body","addedFirstPara","includes","textContent","tag","toLowerCase","clipboardData","setData","NoteContext","createContext","onNoteSubmit","note","rest","Object","assign","lastVerse","VerseNote","isFormOpen","isNoteOpen","value","verse","id","sup","toggleNoteOpen","Consumer","textarea","onInput","onSubmit","type","toggleFormOpen","width","startPunct","endPunct","Verse","color","highlight","highlightStyles","prependSpace","t","n","test","v","res","noted","onDblClick","data-id","getClass","paragraph","qcol","Paragraph","isArray","Paragraphs","paragraphs","p","getLocalNotes","highlighterColors","Reader","selectedColor","onNavChange","text","containedNodes","divRef","ids","getAttribute","fromId","toId","getSelectedNodes","visitParagraphs","highlights","setItem","stringify","setLocalHighlight","removeAllRanges","notes","setLocalNote","fetchChapter","then","undefined","savedNote","visit","visitor","forEach","version","path","padStart","getChapterPath","Promise","resolve","reject","fetch","json","catch","getChapter","scrollTop","article","toolbarContainer","onChange","onBookChange","entries","val","onChapterChange","apply","_el","i","onTextChange","toolbar","onNoteAdd","height","onHighlight","borderBottom","onAddReader","windowButton","onCloseReader","onMouseUp","onKeyUp","reader","Provider","GEN","keys","Readers","readers","offsetXPercent","pageX","initialPageX","innerWidth","preMoveMouseWidths","updateReaders","newReader","splice","lastWidth","setLocalReaders","mouseMoveHandler","r","handler","onMouseMove","onReaderChange","dragbar","onMouseDown","e","Home","_props","About","cssVars","Settings","cssVar","cssValue","setProperty","setLocalCSSVar","cssVal","documentElement","getPropertyValue","trim","setCSSVar","setLocalSetting","componentWillMount","docStyles","docCSSVars","reduce","acc","cur","selectVerseNums","onCSSVarInput","onReset","entry","onSettingInput","readerStyles","testDiv","App","rootElement","getElementById"],"mappings":"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","file":"main.9655c8fb.bundle.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"testDiv\":\"css-3qFxd\",\"form\":\"css-QY6n6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sup\":\"css-3Jtiz\",\"d\":\"css-1o5Cy\",\"noted\":\"css-Nyajp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dragbar\":\"css-3xSTY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"css-G-H7T\",\"navbar\":\"css-2cu9j\",\"navbarGrow\":\"css-sOHx1\",\"navbarBrand\":\"css-3__Qk\",\"form\":\"css-2Cez1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropdown\":\"css-2cQyf\",\"dropdownList\":\"css-1tmWc\",\"dropdownListRight\":\"css-2X-wl\",\"iconButton\":\"css-3AIfq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"p\":\"css-k-P1n\",\"q\":\"css-2KJWD\",\"qcol\":\"css-1HONz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"article\":\"css-3ph2U\",\"reader\":\"css-JUyX7\",\"toolbarContainer\":\"css-2hVKo\",\"toolbar\":\"css-1q3dd\",\"windowButton\":\"css-HDosR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"css-lmpwR\",\"primary\":\"css-1ZDek\",\"secondary\":\"css-1SyN1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"red\":\"css-3yktI\",\"blue\":\"css-1mhF2\",\"gray\":\"css-3rfGi\",\"yellow\":\"css-2Tkur\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sup\":\"css-1Kifr\",\"textarea\":\"css-aYW0c\"};","import { h } from 'preact'\nimport { Link, LinkProps } from 'preact-router/match';\nimport styles from './nav.css'\nimport { bugs } from '../../../package.json';\n\nconst NavLink = (props: Omit<LinkProps, 'activeClassName'>) => (\n\t<Link activeClassName=\"\" {...props} />\n)\n\nexport function Nav() {\n\treturn (\n\t\t<header class={styles.header}>\n\t\t\t<nav class={styles.navbarGrow}>\n\t\t\t\t<ul class={styles.navbar}>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<h1>\n\t\t\t\t\t\t\t<NavLink class={styles.navbarBrand} href=\"/\">\n\t\t\t\t\t\t\t\tOpen Bible\n\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li><NavLink href=\"/about\">About</NavLink></li>\n\t\t\t\t</ul>\n\t\t\t</nav>\n\t\t\t<div style={{ display: 'flex' }}>\n\t\t\t\t<ul class={styles.navbar}>\n\t\t\t\t\t<li><NavLink href=\"/settings\">Settings</NavLink></li>\n\t\t\t\t\t<li><a target=\"_blank\" href={bugs.url}>Report an issue</a></li>\n\t\t\t\t</ul>\n\t\t\t\t<form class={styles.form}>\n\t\t\t\t\t<input placeholder=\"Search\"></input>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</header>\n\t)\n}\n","export function classnames(...args: (string | boolean | null | undefined)[]): string {\n\treturn Array.prototype.slice.call(args).filter(Boolean).join(' ')\n}\n","import { h } from 'preact'\nimport { forwardRef } from 'preact/compat'\nimport { classnames } from '../../utils/classnames'\nimport styles from './button.css'\n\ninterface ButtonProps {\n\tvariant?: string;\n\tonClick?: (ev: any) => void;\n\tclass?: string;\n\tstyle?: string | { [key: string]: string | number };\n\tchildren?: preact.ComponentChildren;\n}\n\nfunction ButtonFunc(props: ButtonProps, ref: preact.Ref<HTMLButtonElement>) {\n\treturn <button\n\t\tref={ref}\n\t\tclass={classnames(\n\t\t\tstyles.button,\n\t\t\tstyles[props.variant || 'primary'],\n\t\t\tprops.class\n\t\t)}\n\t\tonClick={props.onClick}\n\t\tstyle={props.style}\n\t\ttabIndex={0}\n\t>\n\t\t{props.children}\n\t</button>\n}\n\nexport const Button = forwardRef(ButtonFunc)","import { h, Component, toChildArray, createRef } from 'preact'\nimport { Button } from '../button/button'\nimport { classnames } from '../../utils/classnames'\nimport styles from './dropdown.css'\n\ninterface DropdownProps {\n\tonSelect?: (index: number, ev: any) => void;\n\tonClick?: (ev: any) => void;\n\tstyle?: string | { [key: string]: string | number };\n\ticon?: preact.ComponentChild;\n\tselected?: preact.ComponentChild;\n\tisRight?: boolean;\n}\n\ninterface DropdownState {\n\tisOpen: boolean;\n}\n\nexport class Dropdown extends Component<DropdownProps, DropdownState> {\n\tstate = {\n\t\tisOpen: false\n\t}\n\tbuttonRef = createRef()\n\tbuttonRef2 = createRef()\n\tulRef = createRef()\n\n\tclose = (ev?: any) => {\n\t\tif (ev && (ev.target === this.buttonRef.current ||\n\t\t\t\tev.target === this.buttonRef2.current ||\n\t\t\t\tthis.ulRef.current.contains(ev.target))) {\n\t\t\t// Let toggleOpen or selectItem handle it instead\n\t\t\tev.preventDefault()\n\t\t\treturn\n\t\t}\n\t\tthis.setState({ isOpen: false })\n\t\tdocument.removeEventListener('mousedown', this.close)\n\t}\n\n\ttoggleOpen = (_ev: any) => {\n\t\tconst isOpen = this.state.isOpen\n\t\tif (!isOpen) {\n\t\t\tdocument.addEventListener('mousedown', this.close)\n\t\t}\n\t\tthis.setState({ isOpen: !isOpen })\n\t}\n\n\tselectItem = (index: number, ev: any) => {\n\t\tconst bubbleUp = this.props.onSelect\n\t\tif (bubbleUp) {\n\t\t\tbubbleUp(index, ev)\n\t\t}\n\t\tthis.close()\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div class={styles.dropdown}>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tref={this.buttonRef}\n\t\t\t\t\tclass={styles.iconButton}\n\t\t\t\t\tstyle={this.props.style}\n\t\t\t\t\tonClick={this.props.onClick || this.toggleOpen}\n\t\t\t\t>\n\t\t\t\t\t{this.props.selected || 'Choose item'}\n\t\t\t\t</Button>\n\t\t\t\t{this.props.icon && \n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tref={this.buttonRef2}\n\t\t\t\t\t\tclass={styles.iconButton}\n\t\t\t\t\t\tonClick={this.toggleOpen}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.props.icon}\n\t\t\t\t\t</Button>\n\t\t\t\t}\n\t\t\t\t{this.state.isOpen &&\n\t\t\t\t\t<ul\n\t\t\t\t\t\tref={this.ulRef}\n\t\t\t\t\t\tclass={classnames(\n\t\t\t\t\t\t\tstyles.dropdownList,\n\t\t\t\t\t\t\tthis.props.isRight && styles.dropdownListRight\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{toChildArray(this.props.children).map((child, index) =>\n\t\t\t\t\t\t\t<li onClick={ev => this.selectItem(index, ev)}>\n\t\t\t\t\t\t\t\t{child}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ul>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n","export function getChapterPath(\n  version: string,\n  book: string,\n  chapter: number\n) {\n\treturn `./static/${version}/${book}-${(chapter + '').padStart(2, '0')}.json`\n}\n\n// TODO: types\nconst cache = {} as { [key: string]: ParagraphType[] }\n\nexport interface NoteType {\n  note: string;\n  // Need these to pass back up on note submit\n  toId: number;\n  fromId: number;\n  isFormOpen: boolean;\n}\n\nexport interface VerseType {\n  t: string;\n  c?: string;\n  n?: number;\n  v?: string | VerseType[];\n  id: number;\n  // Added by frontend\n  highlight?: string;\n  noted?: string | null;\n  note?: NoteType;\n}\n\nexport interface ParagraphType {\n  t: string;\n  v: VerseType[]\n  id: number;\n}\n\nexport function getChapter(\n  version: string,\n  book: string,\n  chapter: number\n): Promise<ParagraphType[]> {\n  const path = getChapterPath(version, book, chapter)\n  if (!cache[path]) {\n    return new Promise((resolve, reject) => {\n      fetch(path)\n        .then(res => res.json())\n        .then(paragraphs => {\n          resolve(paragraphs)\n          cache[path] = paragraphs\n        })\n        .catch(reject)\n    })\n  }\n\treturn new Promise(resolve => resolve(cache[path]))\n}\n\nexport const books = {\n\t'GEN': {\n    name: 'Genesis',\n    chapters: 50\n  },\n\t'EXO': {\n    name: 'Exodus',\n    chapters: 40\n  },\n\t'LEV': {\n    name: 'Leviticus',\n    chapters: 27\n  },\n\t'NUM': {\n    name: 'Numbers',\n    chapters: 36\n  },\n\t'DEU': {\n    name: 'Deuteronomy',\n    chapters: 34\n  },\n\t'JOS': {\n    name: 'Joshua',\n    chapters: 24\n  },\n\t'JDG': {\n    name: 'Judges',\n    chapters: 21\n  },\n\t'RUT': {\n    name: 'Ruth',\n    chapters: 4\n  },\n\t'1SA': {\n    name: '1 Samuel',\n    chapters: 31\n  },\n\t'2SA': {\n    name: '2 Samuel',\n    chapters: 24\n  },\n\t'1KI': {\n    name: '1 Kings',\n    chapters: 22\n  },\n\t'2KI': {\n    name: '2 Kings',\n    chapters: 25\n  },\n\t'1CH': {\n    name: '1 Chronicles',\n    chapters: 29\n  },\n\t'2CH': {\n    name: '2 Chronicles',\n    chapters: 36\n  },\n\t'EZR': {\n    name: 'Ezra',\n    chapters: 10\n  },\n\t'NEH': {\n    name: 'Nehamiah',\n    chapters: 13\n  },\n\t'EST': {\n    name: 'Esther',\n    chapters: 10\n  },\n\t'JOB': {\n    name: 'Job',\n    chapters: 42\n  },\n\t'PSA': {\n    name: 'Psalm',\n    chapters: 150\n  },\n\t'PRO': {\n    name: 'Proverbs',\n    chapters: 31\n  },\n\t'ECC': {\n    name: 'Ecclessiates',\n    chapters: 12\n  },\n\t'SNG': {\n    name: 'Song of Solomon',\n    chapters: 8\n  },\n\t'ISA': {\n    name: 'Isiah',\n    chapters: 66\n  },\n\t'JER': {\n    name: 'Jeremiah',\n    chapters: 52\n  },\n\t'LAM': {\n    name: 'Lamentations',\n    chapters: 5\n  },\n\t'EZK': {\n    name: 'Ezekiel',\n    chapters: 48\n  },\n\t'DAN': {\n    name: 'Daniel',\n    chapters: 12\n  },\n\t'HOS': {\n    name: 'Hosea',\n    chapters: 14\n  },\n\t'JOL': {\n    name: 'Joel',\n    chapters: 3\n  },\n\t'AMO': {\n    name: 'Amos',\n    chapters: 9\n  },\n\t'OBA': {\n    name: 'Obadiah',\n    chapters: 1\n  },\n\t'JON': {\n    name: 'Jonah',\n    chapters: 4\n  },\n\t'MIC': {\n    name: 'Micah',\n    chapters: 7\n  },\n\t'NAM': {\n    name: 'Nahum',\n    chapters: 3\n  },\n\t'HAB': {\n    name: 'Habakkuk',\n    chapters: 3\n  },\n\t'ZEP': {\n    name: 'Zephaniah',\n    chapters: 3\n  },\n\t'HAG': {\n    name: 'Haggai',\n    chapters: 2\n  },\n\t'ZEC': {\n    name: 'Zechariah',\n    chapters: 14\n  },\n\t'MAL': {\n    name: 'Malachi',\n    chapters: 4\n  },\n\t'MAT': {\n    name: 'Matthew',\n    chapters: 28\n  },\n\t'MRK': {\n    name: 'Mark',\n    chapters: 16\n  },\n\t'LUK': {\n    name: 'Luke',\n    chapters: 24\n  },\n\t'JHN': {\n    name: 'John',\n    chapters: 21\n  },\n\t'ACT': {\n    name: 'Acts',\n    chapters: 28\n  },\n\t'ROM': {\n    name: 'Romans',\n    chapters: 16\n  },\n\t'1CO': {\n    name: '1 Corinthians',\n    chapters: 16\n  },\n\t'2CO': {\n    name: '2 Corinthians',\n    chapters: 13\n  },\n\t'GAL': {\n    name: 'Galatians',\n    chapters: 6\n  },\n\t'EPH': {\n    name: 'Ephesians',\n    chapters: 6\n  },\n\t'PHP': {\n    name: 'Philippians',\n    chapters: 4\n  },\n\t'COL': {\n    name: 'Colossians',\n    chapters: 4\n  },\n\t'1TH': {\n    name: '1 Thessalonians',\n    chapters: 5\n  },\n\t'2TH': {\n    name: '2 Thessalonians',\n    chapters: 3\n  },\n\t'1TI': {\n    name: '1 Timothy',\n    chapters: 6\n  },\n\t'2TI': {\n    name: '2 Timothy',\n    chapters: 4\n  },\n\t'TIT': {\n    name: 'Titus',\n    chapters: 3\n  },\n\t'PHM': {\n    name: 'Philemon',\n    chapters: 1\n  },\n\t'HEB': {\n    name: 'Hebrews',\n    chapters: 13\n  },\n\t'JAS': {\n    name: 'James',\n    chapters: 5\n  },\n\t'1PE': {\n    name: '1 Peter',\n    chapters: 5\n  },\n\t'2PE': {\n    name: '2 Peter',\n    chapters: 3\n  },\n\t'1JN': {\n    name: '1 John',\n    chapters: 5\n  },\n\t'2JN': {\n    name: '2 John',\n    chapters: 1\n  },\n\t'3JN': {\n    name: '3 John',\n    chapters: 1\n  },\n\t'JUD': {\n    name: 'Jude',\n    chapters: 1\n  },\n\t'REV': {\n    name: 'Revelation',\n    chapters: 22\n  },\n}\n\nexport const texts = {\n  'en_ult': 'unfoldingWord® Literal Text',\n  'en_ust': 'unfoldingWord® Simplified Text',\n}\n\nexport type BookNames = keyof typeof books\n","function getKey(book: string, chapter: number) {\n  return `highlight-${book}-${chapter}`\n}\n\nexport interface Highlight {\n  toId: string;\n  color: string;\n}\n\nexport interface Highlights {\n  [fromId: string]: Highlight\n}\n\nexport function getLocalHighlights(\n  book: string,\n  chapter: number\n): Highlights {\n  const key = getKey(book, chapter)\n  return JSON.parse(localStorage.getItem(key) as string) || {}\n}\n\nexport function setLocalHighlight(\n  book: string,\n  chapter: number, \n  fromId: string,\n  toId: string,\n  color: string\n) {\n  const key = getKey(book, chapter)\n  const highlights = getLocalHighlights(book, chapter) || {}\n  highlights[fromId] = { toId, color }\n  localStorage.setItem(key, JSON.stringify(highlights))\n}\n","export function getLocalSetting(setting: string) {\n  return localStorage.getItem(`setting-${setting}`)\n}\n\nexport function setLocalSetting(setting: string, val: string) {\n  localStorage.setItem(`setting-${setting}`, val)\n}","import { getLocalSetting } from '../../utils/settings'\n\n// Handles selecting anywhere in <article> of <Reader>\nexport const selectedNodes: Node[] = []\nconst copyableTags = ['SPAN', 'U']\nconst copyStyles = {\n\tBODY: [\n\t\t'color',\n\t\t'background-color',\n\t\t'font-family',\n\t\t'font-size',\n\t],\n\tP: [\n\t\t'padding-left',\n\t\t'margin',\n\t\t'text-indent',\n\t],\n\tSPAN: [\n\t\t'color',\n\t\t'background-color',\n\t\t'text-decoration',\n\t],\n}\n\nfunction snapToWords(range: Range) {\n\trange.setStart(range.startContainer, 0)\n\tconst length = (range.endContainer as Text).length\n\tif (length) {\n\t\trange.setEnd(range.endContainer, length)\n\t}\n}\n\n// Select API doesn't yet allow selecting multiple ranges\n// Just traverse selected Range and add a class to tags\nfunction iterateOverRange(range: Range, rangeFn: (node: Node) => void) {\n\tconst it = document.createNodeIterator(range.commonAncestorContainer)\n\tlet hitFirstNode = false\n\tlet node: Node\n\twhile (node = it.nextNode() as Node) {\n\t\tif (!hitFirstNode && node === range.startContainer) {\n\t\t\thitFirstNode = true\n\t\t} else if (!hitFirstNode || !node) {\n\t\t\tcontinue\n\t\t}\n\n\t\trangeFn(node)\n\n\t\tif (node === range.endContainer) {\n\t\t\tbreak\n\t\t}\n\t}\n}\n\nfunction getStyles(node: Node) {\n\tconst nodeStyles = getComputedStyle(node as Element)\n\n\treturn (copyStyles[node.nodeName as keyof typeof copyStyles] || [])\n\t\t.filter(style => nodeStyles[style as any])\n\t\t.map(style => `${style}: ${nodeStyles[style as any].replace(/\"/g, '')};`)\n\t\t.join(' ')\n}\n\nexport function getRange() {\n\tconst selection = window.getSelection()\n\tif (!selection || selection.rangeCount === 0) {\n\t\treturn undefined\n\t}\n\tconst range = selection.getRangeAt(0) as Range\n\tif (range.startContainer === range.endContainer &&\n\t\t\trange.startOffset === range.endOffset) {\n\t\treturn undefined\n\t}\n\n\treturn range\n}\n\nexport function onSelectChange() {\n\tconst range = getRange()\n\tif (!range) {\n\t\treturn\n\t}\n\n\tsnapToWords(range)\n\t// Unselect all previously selected nodes\n\tselectedNodes.length = 0\n\t\n\titerateOverRange(range, node => {\n\t\tif (node.nodeName === '#text') {\n\t\t\tselectedNodes.push(node.parentNode as Node)\n\t\t}\n\t})\n}\n\n// TODO\nexport function onDoubleClickVerseNumber(ev: any) {\n\tconsole.log('TODO: select verse', ev)\n  ev.preventDefault()\n}\n\nexport function onCopy(ev: any) {\n\tconst range = getRange()\n\tif (!range || getLocalSetting('selectVerseNums') === 'default') {\n\t\treturn\n\t}\n\tlet toCopy = ''\n\tlet toCopyHTML = `<html>\n<head>\n\t<meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\">\n</head>\n<body style=\"${getStyles(document.body)}\">\n\t<meta charset=\"utf-8\">`\n\tlet addedFirstPara = false\n\titerateOverRange(range, node => {\n\t\tconst parentNode = node.parentNode as Node\n\t\tif (node.nodeName === '#text'\n\t\t\t\t&& copyableTags.includes(parentNode.nodeName)) {\n\t\t\ttoCopy += node.textContent\n\t\t\tif (!addedFirstPara) {\n\t\t\t\ttoCopyHTML += `<p style=\"${getStyles(parentNode.parentNode as Node)}\">`\n\t\t\t\taddedFirstPara = true\n\t\t\t}\n\t\t\tconst tag = parentNode.nodeName.toLowerCase()\n\t\t\ttoCopyHTML += `<${tag} style=\"${getStyles(parentNode)}\">${node.textContent}</${tag}>`\n\t\t}\n\t\telse if (node.nodeName === 'P') {\n\t\t\ttoCopy += '\\n'\n\t\t\ttoCopyHTML += `</p><p style=\"${getStyles(node)}\">`\n\t\t}\n\t\telse if (node.nodeName === 'SUP') {\n\t\t\ttoCopy += ' '\n\t\t\ttoCopyHTML += ' '\n\t\t}\n\t})\n\ttoCopyHTML += '</p></body></html>'\n\tev.clipboardData.setData('text/html', toCopyHTML)\n\tev.clipboardData.setData('text/plain', toCopy)\n\tev.preventDefault()\n}\n","import { createContext } from 'preact'\nimport { NoteType } from '../../utils'\n\ninterface NoteContextType {\n  onNoteSubmit: (note: NoteType) => void;\n}\n\nexport const NoteContext = createContext({\n  onNoteSubmit: (note: NoteType) => {}\n} as NoteContextType)\n","\n\nimport { h } from 'preact';\n\nexport default function (props) {\n    var styles = props.styles;\n    var rest = Object.assign({}, props);\n    delete rest.styles;\n\n    return h('svg', Object.assign({\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 576 512\"}, rest), [\"\\n  \", h('path', {\"d\":\"M402.6 83.2l90.2\\n    90.2c3.8 3.8 3.8\\n    10 0 13.8L274.4\\n    405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8\\n    83.2c3.8-3.8 10-3.8 13.8\\n    0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8\\n    3.8-3.8 10 0\\n    13.8l90.2 90.2c3.8 3.8\\n    10 3.8 13.8\\n    0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2\\n    0 6.2-1.3 8.5-3.5l40-40c7.6-7.6\\n    2.2-20.5-8.5-20.5H48C21.5 64 0\\n    85.5 0 112v352c0\\n    26.5 21.5 48\\n    48 48h352c26.5 0\\n    48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2\\n    2.3-3.5 5.3-3.5 8.5z\"}, []), \"\\n\"]);\n};\n\n        ","import { h, Component, Fragment } from 'preact'\nimport styles from './versenote.css'\nimport { NoteContext } from './notecontext'\nimport { NoteType, VerseType } from '../../utils'\nimport { Button } from '../button/button'\nimport EditIcon from '../../icons/fa-edit.svg'\n\ninterface VerseNoteProps {\n  verse: VerseType;\n}\n\ninterface VerseNoteState {\n  isFormOpen: boolean;\n  isNoteOpen: boolean;\n}\n\nexport class VerseNote extends Component<VerseNoteProps, VerseNoteState> {\n  static id = 0\n  note: NoteType\n\n  constructor(props: VerseNoteProps) {\n    super(props)\n    this.note = this.props.verse.note as NoteType\n    this.state = {\n      isFormOpen: this.note.isFormOpen,\n      isNoteOpen: false\n    }\n  }\n\n  onSubmit = (ev: any, onNoteSubmit: (note: NoteType) => void) => {\n    ev.preventDefault()\n    \n    onNoteSubmit(this.note)\n    this.setState({ isFormOpen: false, isNoteOpen: true })\n  }\n\n  onInput = (ev: any) => {\n    this.note.note = ev.target.value\n  }\n\n  toggleFormOpen = (_ev: any) => {\n    this.setState({ isFormOpen: !this.state.isFormOpen, isNoteOpen: false })\n  }\n\n  toggleNoteOpen = (_ev: any) => {\n    this.setState({ isNoteOpen: !this.state.isNoteOpen })\n  }\n  \n  render() {\n    const id = VerseNote.id++\n    return (\n      <Fragment>\n        <sup\n          class={styles.sup}\n          onClick={this.toggleNoteOpen}\n        >\n          N\n        </sup>\n        {this.state.isFormOpen && (\n          <NoteContext.Consumer>\n            {({ onNoteSubmit }) => (\n              <Fragment>\n                <textarea\n                  form={`versenote-${id}`}\n                  name=\"note\"\n                  class={styles.textarea}\n                  onInput={this.onInput}\n                  value={this.note.note}\n                  placeholder=\"Add note\"\n                />\n                <form\n                  id={`versenote-${id}`}\n                  onSubmit={(ev: any) => this.onSubmit(ev, onNoteSubmit)}\n                >\n                  <input type=\"submit\" value=\"Submit\" />\n                </form>\n              </Fragment>\n            )}\n          </NoteContext.Consumer>\n        )}\n        {this.state.isNoteOpen && (\n          <div>\n            {this.note.note}\n            <sup class={styles.sup} onClick={this.toggleFormOpen}>\n              {' '}<EditIcon width=\"12px\" />\n            </sup>\n          </div>\n        )}\n      </Fragment>\n    )\n  }\n}\n","import { h, Fragment } from 'preact'\nimport { classnames } from '../../utils/classnames'\nimport { onDoubleClickVerseNumber } from './select'\nimport styles from './verse.css'\nimport highlightStyles from './highlights.css'\nimport { VerseType } from '../../utils/books'\nimport { VerseNote } from './versenote'\n\nlet lastVerse: VerseType\nconst startPunct = /['\"“‘\\[\\(\\-]/\nconst endPunct = /['\".”’,?!:;\\]\\)]/\n\ninterface VerseProps {\n  verse: VerseType;\n}\n\nexport function Verse(props: VerseProps) {\n  const verse = props.verse\n  const color = verse.highlight && highlightStyles[verse.highlight]\n  let prependSpace = verse.t === 'w' || verse.t === 't'\n  if (lastVerse && (lastVerse.n\n      || startPunct.test(lastVerse.v as string)\n      || endPunct.test(verse.v as string))) {\n    prependSpace = false\n  }\n  const res = (\n    <Fragment>\n      {prependSpace &&\n        <span class={classnames(\n          lastVerse && lastVerse.highlight && color,\n          lastVerse && lastVerse.noted && verse.noted && styles.noted\n        )}> </span>\n      }\n      {verse.n &&\n        <sup\n          onDblClick={onDoubleClickVerseNumber}\n          class={classnames(\n            styles.sup,\n            color\n          )}\n        >\n          {verse.n}\n        </sup>\n      }\n      {verse.v &&\n        <span\n          data-id={verse.id}\n          class={classnames(\n            styles[verse.t], color,\n            verse.noted && styles.noted\n          )}\n        >\n          {verse.v}\n        </span>\n      }\n      {verse.note &&\n        <VerseNote verse={verse} />\n      }\n    </Fragment>\n  )\n  lastVerse = verse\n  return res\n}\n","import { h, Fragment } from 'preact'\nimport { ParagraphType, VerseType } from '../../utils/books'\nimport { Paragraphs } from './paragraphs'\nimport { Verse } from './verse'\nimport styles from './paragraph.css'\n\nfunction getClass(paragraph: ParagraphType) {\n  if (paragraph.t === 'q' && paragraph.v[0].t === 'v') {\n    return styles.qcol\n  }\n\n  return styles[paragraph.t]\n}\n\ninterface ParagraphProps {\n  paragraph: ParagraphType | VerseType;\n}\n\nexport function Paragraph(props: ParagraphProps) {\n  const paragraph = props.paragraph\n  return (\n    <Fragment>\n      {Array.isArray(paragraph.v)\n        ? <p data-id={paragraph.id} class={getClass(paragraph as ParagraphType)}>\n            <Paragraphs paragraphs={paragraph.v} />\n          </p>\n        : <Verse verse={paragraph} />}\n    </Fragment>\n  )\n}\n","import { h, Fragment } from 'preact'\nimport { Paragraph } from './paragraph'\nimport { ParagraphType, VerseType } from '../../utils/books'\n\ninterface ParagraphsProps {\n  paragraphs?: (ParagraphType | VerseType)[];\n}\n\nexport function Paragraphs(props: ParagraphsProps) {\n  if (!props.paragraphs) {\n    return <div>Loading</div>\n  }\n  return (\n    <Fragment>\n      {props.paragraphs.map(p =>\n        <Paragraph paragraph={p} />\n      )}\n    </Fragment>\n  )\n}\n","function getKey(book: string, chapter: number) {\n  return `note-${book}-${chapter}`\n}\n\nexport interface SavedNote {\n  toId: string;\n  note: string;\n}\n\ninterface Notes {\n  [fromId: string]: SavedNote\n}\n\nexport function getLocalNotes(\n  book: string,\n  chapter: number\n): Notes {\n  const key = getKey(book, chapter)\n  return JSON.parse(localStorage.getItem(key) as string) || {}\n}\n\nexport function setLocalNote(\n  book: string,\n  chapter: number, \n  fromId: string,\n  toId: string,\n  note: string\n) {\n  const key = getKey(book, chapter)\n  const notes = getLocalNotes(book, chapter) || {}\n  notes[fromId] = { toId, note }\n  localStorage.setItem(key, JSON.stringify(notes))\n}\n","\n\nimport { h } from 'preact';\n\nexport default function (props) {\n    var styles = props.styles;\n    var rest = Object.assign({}, props);\n    delete rest.styles;\n\n    return h('svg', Object.assign({\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 544 512\"}, rest), [\"\\n  \", h('path', {\"d\":\"M0 479.98L99.92\\n      512l35.45-35.45-67.04-67.04L0\\n      479.98zm124.61-240.01a36.592\\n      36.592 0 0\\n      0-10.79 38.1l13.05 42.83-50.93\\n      50.94 96.23 96.23\\n      50.86-50.86 42.74 13.08c13.73\\n      4.2 28.65-.01 38.15-10.78l35.55-41.64-173.34-173.34-41.52\\n      35.44zm403.31-160.7l-63.2-63.2c-20.49-20.49-53.38-21.52-75.12-2.35L190.55\\n      183.68l169.77 169.78L530.27 154.4c19.18-21.74\\n      18.15-54.63-2.35-75.13z\"}, []), \"\\n\"]);\n};\n\n        ","\n\nimport { h } from 'preact';\n\nexport default function (props) {\n    var styles = props.styles;\n    var rest = Object.assign({}, props);\n    delete rest.styles;\n\n    return h('svg', Object.assign({\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\"}, rest), [\"\\n  \", h('path', {\"fill\":\"none\",\"d\":\"M0 0h24v24H0V0z\"}, []), \"\\n  \", h('path', {\"d\":\"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4-.01-18zM17 11h-4v4h-2v-4H7V9h4V5h2v4h4v2z\"}, []), \"\\n\"]);\n};\n\n        ","import { h, Component, createRef } from 'preact'\nimport { Button } from '../button/button'\nimport { Dropdown } from '../dropdown/dropdown'\nimport { getChapter, books, texts, BookNames } from '../../utils'\nimport { ParagraphType, VerseType, NoteType } from '../../utils/books'\nimport { getLocalHighlights, setLocalHighlight, Highlight } from '../../utils/highlights'\nimport { onSelectChange, onCopy, selectedNodes, getRange } from '../paragraphs/select'\nimport { NoteContext } from '../paragraphs/notecontext'\nimport { Paragraphs } from '../paragraphs/paragraphs'\nimport { setLocalNote, getLocalNotes, SavedNote } from '../../utils/notes'\nimport HighlighterIcon from '../../icons/fa-highlighter.svg'\nimport AddCommentIcon from '../../icons/md-add-comment.svg'\nimport styles from './reader.css'\n\nconst highlighterColors = ['red', 'blue', 'gray', 'yellow']\n\nexport interface ReaderProps {\n\ttext: string;\n\tbook: BookNames;\n\tchapter: number;\n\t// TODO: how to copy JSXInternal.HTMLAttributes<HTMLElement>.style?: string | {\n\tstyle?: { [key: string]: string | number } | string;\n\tonAddReader?: () => void;\n\tonCloseReader?: () => void;\n\tonNavChange?: (text: string, book: BookNames, chapter: number) => void\n}\n\ninterface ReaderState {\n\tparagraphs?: ParagraphType[];\n\tselectedColor: string;\n}\n\nexport class Reader extends Component<ReaderProps, ReaderState> {\n\tstatic defaultProps = {\n\t\tbook: books.GEN,\n\t\tchapter: 1,\n\t\ttext: Object.keys(texts)[0]\n\t}\n\n\tstate = {\n\t\tparagraphs: [],\n\t\tselectedColor: highlighterColors[0]\n\t} as ReaderState\n\n\tdivRef = createRef()\n\n\tvisit(\n\t\tverse: ParagraphType | VerseType,\n\t\tvisitor: (verse: VerseType) => void\n\t) {\n\t\tvisitor(verse)\n\t\tif (Array.isArray(verse.v)) {\n\t\t\t(verse as ParagraphType).v.forEach(v => this.visit(v, visitor))\n\t\t}\n\t}\n\n\tvisitParagraphs(\n\t\tparagraphs: ParagraphType[] | undefined,\n\t\tvisitor: (verse: VerseType) => void\n\t) {\n\t\tif (!paragraphs) {\n\t\t\treturn\n\t\t}\n\t\tparagraphs.forEach(p => this.visit(p, visitor))\n\t}\n\n\tconstructor(props: ReaderProps) {\n\t\tsuper(props)\n\t\tthis.fetchChapter(props.text, props.book, props.chapter)\n\t\t\t.then(paragraphs => {\n\t\t\t\tconst highlights = getLocalHighlights(this.props.book, this.props.chapter)\n\t\t\t\tconst notes = getLocalNotes(this.props.book, this.props.chapter)\n\t\t\t\tlet highlight: Highlight | undefined\n\t\t\t\tlet note: NoteType | undefined\n\t\t\t\tthis.visitParagraphs(paragraphs, verse => {\n\t\t\t\t\tif (!highlight) {\n\t\t\t\t\t\thighlight = highlights[verse.id]\n\t\t\t\t\t}\n\t\t\t\t\tif (highlight) {\n\t\t\t\t\t\tverse.highlight = highlight.color\n\t\t\t\t\t\tif (verse.id >= +highlight.toId) {\n\t\t\t\t\t\t\thighlight = undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst savedNote = notes[verse.id]\n\t\t\t\t\tif (!note && savedNote) {\n\t\t\t\t\t\tnote = {\n\t\t\t\t\t\t\tfromId: verse.id,\n\t\t\t\t\t\t\ttoId: +savedNote.toId,\n\t\t\t\t\t\t\tnote: savedNote.note,\n\t\t\t\t\t\t\tisFormOpen: false,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (note) {\n\t\t\t\t\t\tverse.noted = verse.id + ''\n\t\t\t\t\t\tif (verse.id >= note.toId) {\n\t\t\t\t\t\t\tverse.note = note\n\t\t\t\t\t\t\tnote = undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis.setState({ paragraphs })\n\t\t\t})\n\t}\n\n\tfetchChapter(text: string, book: string, chapter: number) {\n\t\treturn getChapter(text, book, chapter)\n\t\t\t.then(paragraphs => {\n\t\t\t\tthis.setState({ paragraphs })\n\t\t\t\tthis.divRef.current.scrollTop = 0\n\t\t\t\treturn paragraphs\n\t\t\t})\n\t}\n\n\tonNavChange(text: string, book: BookNames, chapter: number) {\n\t\tthis.fetchChapter(text, book, chapter)\n\t\tif (this.props.onNavChange) {\n\t\t\tthis.props.onNavChange(text, book, chapter)\n\t\t}\n\t}\n\n\tonBookChange = (ev: any) => {\n\t\tconst book = ev.target.value as BookNames\n\t\tlet chapter = this.props.chapter\n\t\tif (chapter > books[book].chapters)\n\t\t\tchapter = books[book].chapters\n\t\tthis.onNavChange(this.props.text, book, chapter)\n\t}\n\n\tonChapterChange = (ev: any) => {\n\t\tthis.onNavChange(this.props.text, this.props.book, ev.target.value)\n\t}\n\n\tonTextChange = (ev: any) => {\n\t\tthis.onNavChange(ev.target.value, this.props.book, this.props.chapter)\n\t}\n\n\tgetSelectedNodes = () => {\n\t\tif (!getRange()) {\n\t\t\treturn\n\t\t}\n\t\tconst containedNodes = selectedNodes\n\t\t\t.filter(node => this.divRef.current.contains(node))\n\n\t\tconst ids = containedNodes\n\t\t\t.map(node => (node as Element).getAttribute('data-id'))\n\t\t\t.filter(Boolean)\n\t\treturn {\n\t\t\tcontainedNodes,\n\t\t\tfromId: ids[0],\n\t\t\ttoId: ids[ids.length - 1]\n\t\t}\n\t}\n\n\tonHighlight = (color: string) => {\n\t\tconst selected = this.getSelectedNodes()\n\t\tif (!selected) {\n\t\t\treturn\n\t\t}\n\n\t\tconst paragraphs = this.state.paragraphs\n\t\tif (selected.fromId && selected.toId) {\n\t\t\tconst fromId = +selected.fromId\n\t\t\tconst toId = +selected.toId\n\t\t\tthis.visitParagraphs(paragraphs, verse => {\n\t\t\t\tif (verse.id >= fromId && verse.id <= toId) {\n\t\t\t\t\tverse.highlight = color\n\t\t\t\t}\n\t\t\t})\n\t\t\tthis.setState({ paragraphs })\n\n\t\t\t// Save locally\n\t\t\tsetLocalHighlight(\n\t\t\t\tthis.props.book,\n\t\t\t\tthis.props.chapter,\n\t\t\t\tselected.fromId,\n\t\t\t\tselected.toId,\n\t\t\t\tcolor\n\t\t\t)\n\t\t\tconst selection = document.getSelection()\n\t\t\tif (selection) {\n\t\t\t\tselection.removeAllRanges()\n\t\t\t}\n\t\t}\n\t}\n\n\tonNoteAdd = () => {\n\t\tconst selected = this.getSelectedNodes()\n\t\tif (!selected) {\n\t\t\treturn\n\t\t}\n\n\t\tconst paragraphs = this.state.paragraphs\n\t\tif (selected.fromId && selected.toId) {\n\t\t\tconst fromId = +selected.fromId\n\t\t\tconst toId = +selected.toId\n\t\t\tthis.visitParagraphs(paragraphs, v => {\n\t\t\t\tif (v.id >= fromId && v.id <= toId) {\n\t\t\t\t\tv.noted = selected.fromId\n\t\t\t\t}\n\t\t\t\tif (v.id === toId) {\n\t\t\t\t\tv.note = { fromId, toId, note: '', isFormOpen: true }\n\t\t\t\t}\n\t\t\t})\n\t\t\tthis.setState({ paragraphs })\n\n\t\t\tconst selection = document.getSelection()\n\t\t\tif (selection) {\n\t\t\t\tselection.removeAllRanges()\n\t\t\t}\n\t\t}\n\t}\n\n\tonNoteSubmit = (note: NoteType) => {\n\t\tsetLocalNote(\n\t\t\tthis.props.book,\n\t\t\tthis.props.chapter,\n\t\t\tnote.fromId + '',\n\t\t\tnote.toId + '',\n\t\t\tnote.note\n\t\t)\n\t\tthis.setState({ paragraphs: this.state.paragraphs })\n\t}\n\n\trender() {\n\t\tconst selectedColor = this.state.selectedColor\n\t\tconst style = this.props.style || {}\n\t\treturn (\n\t\t\t<article class={styles.article} style={style}>\n\t\t\t\t<div class={styles.toolbarContainer}>\n\t\t\t\t\t<nav>\n\t\t\t\t\t\t<select name=\"book\" value={this.props.book} onChange={this.onBookChange}>\n\t\t\t\t\t\t\t{Object.entries(books).map(([key, val]) =>\n\t\t\t\t\t\t\t\t<option value={key} key={key}>{val.name}</option>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<select name=\"chapter\" value={this.props.chapter} onChange={this.onChapterChange}>\n\t\t\t\t\t\t\t{Array.apply(null, Array(books[this.props.book].chapters))\n\t\t\t\t\t\t\t\t.map((_el: unknown, i: number) =>\n\t\t\t\t\t\t\t\t\t<option value={i + 1} key={i}>{i + 1}</option>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<select name=\"text\" value={this.props.text} onChange={this.onTextChange}>\n\t\t\t\t\t\t\t{Object.entries(texts).map(([key, val]) => \n\t\t\t\t\t\t\t\t<option value={key} key={key}>{key}</option>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</nav>\n\t\t\t\t\t<div class={styles.toolbar}>\n\t\t\t\t\t\t<Button variant=\"secondary\" onClick={this.onNoteAdd}>\n\t\t\t\t\t\t\t<AddCommentIcon height=\"12px\" style=\"fill: #5f6368;\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Dropdown\n\t\t\t\t\t\t\tisRight\n\t\t\t\t\t\t\ticon=\"▼\"\n\t\t\t\t\t\t\tselected={<HighlighterIcon height=\"12px\" style=\"fill: #5f6368;\" />}\n\t\t\t\t\t\t\tonSelect={(index: number) => {\n\t\t\t\t\t\t\t\tthis.setState({ selectedColor: highlighterColors[index] })\n\t\t\t\t\t\t\t\tthis.onHighlight(highlighterColors[index])\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonClick={() => this.onHighlight(selectedColor)}\n\t\t\t\t\t\t\tstyle={{ borderBottom: `4px solid ${this.state.selectedColor}` }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{highlighterColors.map(color =>\n\t\t\t\t\t\t\t\t<HighlighterIcon value={color} height=\"12px\" style={`fill: ${color};`} />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Dropdown>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tonClick={this.props.onAddReader}\n\t\t\t\t\t\t\tclass={styles.windowButton}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t+\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tonClick={this.props.onCloseReader}\n\t\t\t\t\t\t\tclass={styles.windowButton}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tx\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tref={this.divRef}\n\t\t\t\t\tonMouseUp={onSelectChange}\n\t\t\t\t\tonKeyUp={onSelectChange}\n\t\t\t\t\tclass={styles.reader}\n\t\t\t\t\tonCopy={onCopy}\n\t\t\t\t\ttabIndex={0}\n\t\t\t\t>\n\t\t\t\t\t<NoteContext.Provider value={{\n\t\t\t\t\t\tonNoteSubmit: this.onNoteSubmit\n\t\t\t\t\t}}>\n\t\t\t\t\t\t<Paragraphs\tparagraphs={this.state.paragraphs} />\n\t\t\t\t\t</NoteContext.Provider>\n\t\t\t\t</div>\n\t\t\t</article>\n\t\t)\n\t}\n}\n","import { h, Component, Fragment } from 'preact'\nimport { Reader, ReaderProps } from '../reader/reader'\nimport { setLocalReaders, getLocalReaders } from '../../utils/readers'\nimport { BookNames } from '../../utils'\nimport styles from './readers.css'\n\nexport interface ReaderState extends ReaderProps {\n\twidth: number;\n}\n\ninterface ReadersState {\n\treaders: ReaderState[];\n}\n\n/*\n *\tContains many <Reader>s and handles resizing them\n */\nexport class Readers extends Component<{}, ReadersState> {\n\tstate = {\n\t\treaders: [\n\t\t\t{ text: 'en_ult', book: 'LUK' as BookNames, chapter: 4, width: 50 },\n\t\t\t{ text: 'en_ult', book: 'PSA' as BookNames, chapter: 119, width: 50 },\n\t\t]\n\t} as ReadersState\n\tpreMoveMouseWidths: number[] = []\n\tinitialPageX = 0\n\n\tconstructor(props: {}) {\n\t\tsuper(props)\n\t\tconst readers = getLocalReaders()\n\t\tif (readers.length > 0) {\n\t\t\tthis.state = { readers }\n\t\t} else {\n\t\t\tthis.state.readers.forEach(reader =>\n\t\t\t\treader.width = 1 / this.state.readers.length)\n\t\t}\n\t}\n\n\tupdateReaders() {\n\t\tconst readers = this.state.readers\n\t\tsetLocalReaders(readers)\n\t\tthis.setState({ readers })\n\t}\n\n\tonMouseMove = (ev: any, index: number) => {\n\t\tev.preventDefault()\n\t\tconst offsetXPercent = (ev.pageX - this.initialPageX) / window.innerWidth\n\t\tthis.state.readers.forEach((reader, i) => {\n\t\t\tif (i === index)\n\t\t\t\treader.width = this.preMoveMouseWidths[i] + offsetXPercent\n\t\t\telse if (i === index + 1)\n\t\t\t\treader.width = this.preMoveMouseWidths[i] - offsetXPercent\n\t\t})\n\t\tthis.updateReaders()\n\t}\n\n\tmouseMoveHandler(ev: any, index: any) {\n\t\tev.preventDefault()\n\t\tthis.initialPageX = ev.pageX\n\t\tthis.preMoveMouseWidths = this.state.readers.map(r => r.width)\n\t\t\n\t\tconst handler = (ev: any) => this.onMouseMove(ev, index)\n\t\tdocument.addEventListener('mousemove', handler)\n\t\tdocument.addEventListener('mouseup', _ev =>\n\t\t\tdocument.removeEventListener('mousemove', handler))\n\t}\n\n\tonAddReader = (index: number) => {\n\t\tconst readers = this.state.readers\n\t\tconst newReader = Object.assign({}, readers[index])\n\t\treaders.splice(index, 0, newReader)\n\t\tthis.updateReaders()\n\t}\n\n\tonCloseReader = (index: number) => {\n\t\tconst readers = this.state.readers\n\t\tconst lastWidth = readers[index].width\n\t\treaders.splice(index, 1)\n\t\treaders.forEach(reader => reader.width += lastWidth / readers.length)\n\t\tthis.updateReaders()\n\t}\n\n\tonReaderChange = (reader: ReaderState, text: string, book: BookNames, chapter: number) => {\n\t\treader.text = text\n\t\treader.book = book\n\t\treader.chapter = chapter\n\t\tthis.updateReaders()\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{this.state.readers.map((reader, index) => (\n\t\t\t\t\t<Fragment key={index}>\n\t\t\t\t\t\t<Reader\n\t\t\t\t\t\t\ttext={reader.text}\n\t\t\t\t\t\t\tbook={reader.book}\n\t\t\t\t\t\t\tchapter={reader.chapter}\n\t\t\t\t\t\t\tstyle={{ width: `${reader.width * 100}%` }}\n\t\t\t\t\t\t\tonAddReader={() => this.onAddReader(index)}\n\t\t\t\t\t\t\tonCloseReader={() => this.onCloseReader(index)}\n\t\t\t\t\t\t\tonNavChange={(text, book, chapter) => this.onReaderChange(reader, text, book, chapter)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{index !== this.state.readers.length - 1 &&\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass={styles.dragbar}\n\t\t\t\t\t\t\t\tonMouseDown={e => this.mouseMoveHandler(e, index)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Fragment>\n\t\t\t\t))}\n\t\t\t</Fragment>\n\t\t)\n\t}\n}\n","import { ReaderState } from '../components/readers/readers'\n\nfunction getKey() {\n  return 'readers'\n}\n\nexport function getLocalReaders(): ReaderState[] {\n  const key = getKey()\n  return JSON.parse(localStorage.getItem(key) as string) || []\n}\n\nexport function setLocalReaders(readers: ReaderState[]) {\n  const key = getKey()\n  localStorage.setItem(key, JSON.stringify(readers))\n}\n","import { h, Fragment } from 'preact'\nimport { Nav, Readers } from '../components'\n\nexport const Home = (_props: { path: String }) => (\n\t<Fragment>\n\t\t<Nav />\n\t\t<main>\n\t\t\t<Readers />\n\t\t</main>\n\t</Fragment>\n)","import { h, Fragment } from 'preact'\nimport { Nav } from '../components'\n\nexport const About = (_props: { path: String }) => (\n\t<Fragment>\n\t\t<Nav />\n\t\t<main>\n\t\t\t<div>\n\t\t\t\t<h2>About</h2>\n\t\t\t\t<p>\n\t\t\t\t\tThis is a site that (so far) renders\n\t\t\t\t\tthe <a href=\"https://git.door43.org/unfoldingWord/en_ult\">en_ult</a>\n\t\t\t\t\t&nbsp;and <a href=\"https://git.door43.org/unfoldingWord/en_ust\">en_ust</a> translations.\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\tIt does so by rendering the USFM markdown to JSON\n\t\t\t\t\tin <a href=\"https://github.com/thesmartwon/usfm2json\">usfm2json</a> to paragraphs,\n\t\t\t\t\tand then rendering those paragraphs to HTML following some rules for verse numbers,\n\t\t\t\t\tpunctuation, highlights, and notes. Currently your highlights and notes are saved\n\t\t\t\t\tto your browser's local storage.\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\tIt's written using&nbsp;\n\t\t\t\t\t<a href=\"https://preactjs.com/\">Preact</a>\n\t\t\t\t\t, <a href=\"https://babeljs.io/\">Babel</a>\n\t\t\t\t\t, and a lot of <a href=\"https://webpack.js.org/\">Webpack</a> sorcery.\n\t\t\t\t\tThe few icons come\n\t\t\t\t\tfrom <a href=\"https://fontawesome.com/\">FontAwesome</a>&nbsp;\n\t\t\t\t\tor <a href=\"https://material.io/resources/icons/\">Material Design.</a>\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\tThe source code is available\n\t\t\t\t\ton <a href=\"https://github.com/thesmartwon/openbible\">Github</a> and it's\n\t\t\t\t\tdeployed\n\t\t\t\t\tusing <a href=\"https://pages.github.com/\">Github Pages.</a>&nbsp;\n\t\t\t\t\tI welcome contributions, there's still a lot of work to be done!\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</main>\n\t</Fragment>\n)","// TODO: use custom loader on ../app.css\nexport const cssVars = [\n  '--primary-text-color',\n  '--primary-text-indent',\n  '--primary-theme-color',\n  '--primary-font-family',\n]\n\nexport function loadLocalCSSVars() {\n  const rootElement = document.body\n  cssVars.forEach(cssVar => {\n    rootElement.style.setProperty(cssVar, localStorage.getItem(`css-${cssVar}`))\n  })\n}\n\nexport function setLocalCSSVar(cssVar: string, value: string) {\n  localStorage.setItem(`css-${cssVar}`, value)\n}","import { h, Fragment, Component } from 'preact'\nimport { Nav, Reader, Button, Dropdown } from '../components'\nimport { cssVars, setLocalCSSVar } from '../utils/cssVars'\nimport { getLocalSetting, setLocalSetting } from '../utils/settings'\nimport styles from './settings.css'\nimport readerStyles from '../components/reader/reader.css'\n\ninterface SettingsState {\n  cssVars: { [key: string]: string };\n  selectVerseNums: string;\n}\n\nexport class Settings extends Component<{}, SettingsState> {\n  componentWillMount() {\n    const docStyles = getComputedStyle(document.body)\n    const docCSSVars = cssVars\n      .reduce((acc, cur) => {\n        acc[cur] = docStyles.getPropertyValue(cur).trim()\n        return acc\n      }, {} as { [key: string]: string })\n\n    this.setState({\n      cssVars: docCSSVars,\n      selectVerseNums: getLocalSetting('selectVerseNums') || 'noSelect'\n    })\n  }\n\n  setCSSVar = (cssVar: string, cssValue: string) => {\n    document.body.style.setProperty(cssVar, cssValue)\n    this.state.cssVars[cssVar] = cssValue\n    setLocalCSSVar(cssVar, cssValue)\n  }\n\n  onCSSVarInput(cssVar: string, ev: any) {\n    this.setCSSVar(cssVar, ev.target.value)\n  }\n\n  onSubmit = (ev: h.JSX.TargetedEvent<HTMLFormElement, Event>) => {\n    ev.preventDefault()\n    // TODO: web service\n    console.log('save settings', this.state)\n  }\n\n  onReset = (ev: h.JSX.TargetedEvent<HTMLFormElement, Event>) => {\n    ev.preventDefault()\n    cssVars.forEach(cssVar => {\n      const cssVal = getComputedStyle(document.documentElement)\n        .getPropertyValue(cssVar)\n        .trim()\n      this.setCSSVar(cssVar, cssVal)\n    })\n    this.setState(this.state)\n  }\n\n  onSettingInput = (key: string, val: string) => {\n    setLocalSetting(key, val)\n    this.setState({ [key]: val })\n  }\n\n  render() {\n    return (\n      <Fragment>\n        <Nav />\n        <main>\n          <form class={styles.form} onSubmit={this.onSubmit} onReset={this.onReset}>\n            <h2>CSS Variables</h2>\n            {Object.entries(this.state.cssVars)\n              .map(entry => (\n                <p key={entry[0]}>\n                  <label>{entry[0]}</label>\n                  <input\n                    type={entry[0].includes('color') ? 'color' : ''}\n                    value={entry[1]}\n                    onInput={e => this.onCSSVarInput(entry[0], e)}\n                    />\n                </p>\n            ))}\n            <h2>Copy behavior</h2>\n            <p>\n              <label>Snap selection to words</label>\n              TODO: code no snapping but still snapping for highlighting\n            </p>\n            <p>\n              <label>Verse number selection</label>\n              <select\n                value={this.state.selectVerseNums}\n                onChange={(ev: any) => this.onSettingInput('selectVerseNums', ev.target.value)}\n              >\n                <option value=\"noSelect\">Don't select</option>\n                <option value=\"addSpace\">Add space</option>\n                <option value=\"default\">Browser default</option>\n              </select>\n            </p>\n            <input type=\"reset\" value=\"Reset settings\" />\n            <input type=\"submit\" value=\"Save settings\" />\n          </form>\n          <div class={`${readerStyles.reader} ${styles.testDiv}`}>\n            <Button>Primary button</Button>\n            <Button variant=\"secondary\">Secondary button</Button>\n            <Dropdown>\n              <div>Item 1</div>\n              <div>Item 2</div>\n              <div>Item 3</div>\n            </Dropdown>\n            <Reader book=\"PSA\" chapter={119} />\n          </div>\n        </main>\n      </Fragment>\n    )\n  }\n}","import { h, render, Component } from 'preact'\nimport Router from 'preact-router'\nimport { Home, About, Settings } from './pages'\nimport { loadLocalCSSVars } from './utils/cssVars'\nimport './app.css'\n\nclass App extends Component {\n\tcomponentWillMount() {\n\t\tloadLocalCSSVars()\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Router>\n\t\t\t\t<Home path=\"/\" />\n\t\t\t\t<About path=\"/about\" />\n\t\t\t\t<Settings path=\"/settings\" />\n\t\t\t</Router>\n\t\t)\n\t}\n}\n\nrender(<App />, document.getElementById('root') as HTMLElement)\n"],"sourceRoot":""}